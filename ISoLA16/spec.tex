\section{From Whence the Specification}~\label{sec:req}

If high assurance RV is to ensure safety of autonomous systems, then great care must be given to
the monitor specifications.  It is not sufficient to simply find a property
to monitor, a convincing safety case~\cite{Kelly98arguingsafety} will
require evidence that the monitor specifications do indeed provide the
advertised protection and some argument that they are complete.
Rushby's proposal~\cite{rvRushby,RushbyAIAA09} proposal for a using RV
in a safety case of IA systems is instructive in that the efficacy of
the monitor is paramount.  A safety case should fully enumerate the
set of assumptions on which safe operation of the system rests and the
monitor needs to test for the violation of these assumptions as well
as other safety criteria. 


 Sound systems engineering practices  as well
as regulatory guidelines typically mandate safety-critical systems
have detailed written requirements and as well as a through safety
assessment.  It is crucial that the monitor specification be derived
from the safety analyses. Thus leading to our first challenge for
assured RV.
%\noindent\fbox{%
%    \parbox{\textwidth}{%

\paragraph{Challenge}   \emph{ Monitor specifications should derive from
  system level requirements and assumptions that have been validated
  by domain experts.} 

\paragraph{Copilot Approach} We are conducting case studies informed
by collaborations with colleagues who are developing new concepts that
will enable aircraft to perform autonomous flight by self-optimizing
their four-dimensional trajectories while conforming to constraints
such as required times of arrival generated by air-traffic service
providers on the ground. Proposals being investigated use genetic
algorithms~\cite{KarrVRC} and do not always behave with the
predictability of conventional systems. While these algorithms may
greatly improve the efficiency of the airspace, it has not been
possible to provide the required level of assurance that the newly
computed trajectories preserve safe aircraft separation, where the
separation requirement for two aircraft is specified by a minimum
horizontal separation $D$ (typically, $5$ nautical miles).  The
obvious specification is simply check to see if the aircraft have
violated separation and take corrective action.  Yet the system level
needs demanded a specificatio that the aircract will not come into
conflict meaning separation is not lost in at some time $t>0.$
Fortuitously, colleagues at NASA have discovered analytical formula,
called \emph{criteria}~\cite{NM2011NASA,NMH14ATIO} that characterize
those resolution maneuvers that both ensure safe separation when one
aircraft maneuvers and ensures separation when two conflicting
aircraft both maneuver. These are expressed as a set of formula
involving the position and velocity vectors of the two
aircraft. Researchers have also enumerated a number of assumptions
that must hold for the formula to hold. The criteria have been
extensively validated by domain experts emplying sophisticated
simulation as well as mathematical proof using the Prototype
Verification System (PVS) theorem prover. These criteria were encoded
as Copilot specificaitons. The criteria for horizontal separation for
two aircradt is given as follows:
%$$ \texttt{horizontal\_criteria}(\bm{s}, \epsilon)(\bm{v'})
%\equiv  \bm{s} \cdot \bm{v'} \geq \epsilon  \frac{\sqrt{\bm{s} \cdot
%  \bm{s}  - D^2}} {D} \operatorname{det}(\bm{s},\bm{v'})$$ 

\begin{eqnarray*} \texttt{horizontal\_criteria}(\bm{s}, \epsilon, \bm{v})
& \equiv &  \bm{s} \cdot \bm{v} \geq \epsilon  \frac{\sqrt{\bm{s} \cdot
  \bm{s}  - D^2}} {D} \operatorname{det}(\bm{s},\bm{v})  \\
& \wedge &  \epsilon \operatorname{det}(\bm{s},\bm{v})  \leq  0 
\end{eqnarray*}


where $\bm{s}$ and $\bm{v}$ are the  relative position and velocity
vectors for the two aircraft, $\epsilon$ is $1$ or $-1,$  and 
$\bm{v}$ is the relative velocity vector after a planned maneuver. 

This is condition is easily encoded in  Copilot's EDSL as:

\begin{lstlisting}[frame=single]
scalar2dim :: Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Double
scalar2dim x1 y1 x2 y2 = (x1 * x2) + (y1 * y2)

normsq2dim :: Stream Double -> Stream Double -> Stream Double
normsq2dim x y = scalar2dim x y x y

norm2dim :: Stream Double -> Stream Double -> Stream Double
norm2dim x y = sqrt (normsq2dim x y)

det2dim :: Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Double
det2dim x1 y1 x2 y2 = (x1 * y2) - (x2 * y1)

----------------------------------------
-- Horizontal Criterion for Conflict Resolution
----------------------------------------

hor_rr :: Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Double
hor_rr sx sy e v'x v'y = (sqrt $ (normsq2dim sx sy) - (minHorSep * minHorSep)) / (minHorSep)

horizontalCriterionForConflictResolution :: Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Double -> Stream Bool
horizontalCriterionForConflictResolution sx sy e v'x v'y = ((scalar2dim sx sy v'x v'y) >= (e * (hor_rr sx sy e v'x v'y) * (det2dim sx sy v'x v'y)) ) && ( ((det2dim sx sy v'x v'y) *e)  <= 0.0)
\end{lstlisting}

Formalizing the assumptions about the reliability of communicating
aircraft position data is ongoing work. 

\paragraph{Opportunities} We have fond case studies involving both
domain and safety experts invaluable at informing our research agenda
high assurance RV and encourage researchers working in the area to do
so as well.  Tools that can aide domain experts in validating safety
properties are in sorely needed.  As in our case study, the safety
properties of cyber-physical systems are involve continuous
mathematics. While advances in SMT solvers have been impressive, it is
still necessary to often resort to interactive theorem provers, which
require specialized skills that domain experts are not likely to
obtain.  There are many opportunities to design  domain specific decision procedures
that can help automate a class of analyses. 



 








%\begin{itemize}
%\item Safety-Critical that that are considered ultra-critical systems
% typically have detailed requirements

%\item established that only ``safety properties'' can be checked with
%  RV 
% \item For adaptive systems where RV is the entrusted repository of
%  predictability and guarantor of safety we must make sure that we are
%  actually checking properties based on formal requirements.
% \item Need to make sure that the RV safety properties are derived
%  from requirements. 
% \item Criteria based separation example an excellent example in that
%  has undergone extensive analysis both simulation and formal
%  analytical proof.  Assumptions are well spelled out. 
% \item NASA is investigating sophisticated AI based  flight management
%  software. Such systems cannot be certified by traditional means, but
%  the criteria can an can serve as the basis for RV. 
%\item EDSL we strive to build libraries allow specification in this
%  sort of notation. 
%\end{itemize}


